# 📋 성장예측 그래프 기능 업데이트 (팀 공유용)

## ✅ 업데이트 완료 사항

### 1️⃣ Y축 범위 동적 설정
- **변경 전**: 고정 범위 (0-180cm)
- **변경 후**: **종분석 데이터 기반 동적 범위**
  - Y축 시작값: 해당 종의 발아단계 최소 크기 (초기 크기의 90%)
  - Y축 끝값: 해당 종의 최대 성장 크기 (최대 크기의 110%)
- **효과**: 식물 종별 특성에 맞는 정확한 그래프 표시

### 2️⃣ 그래프 라인 개수 변경
- **변경 전**: 3개 라인 (좋은 조건, 나쁜 조건, 예상)
- **변경 후**: **2개 라인만 표시**
  - ✅ 좋은 조건 생장 그래프 (빨간색 실선 `#dc2626`)
  - ⚠️ 나쁜 조건 생장 그래프 (빨간색 점선 `#ef4444`)
- **효과**: 직관적이고 명확한 비교 가능

### 3️⃣ 데이터 흐름 개선
- **종분석 데이터** → **성장예측 그래프지표 값** + **좋은/나쁜 조건 설명 텍스트**
- 각 기간별로 다음 정보 제공:
  - ✅ 좋은 조건 분석: 상세한 정보분석 내용 및 조언
  - ⚠️ 나쁜 조건 설명: 어떤 조건인지 설명
  - ⚠️ 나쁜 조건 영향: 식물 상태 및 수명 예상

---

## 🔧 기술적 변경 사항

### 백엔드 변경
1. **스키마 업데이트** (`app/models/schemas.py`)
   - `GrowthGraph` 스키마에서 `expected_growth` 필드 제거
   - `min_size`, `max_size` 필드 추가 (Y축 범위용)

2. **그래프 생성 함수** (`app/services/growth.py`)
   - `generate_growth_graph()`: 좋은/나쁜 조건 그래프만 생성
   - Y축 범위 자동 계산 (발아단계 ~ 최대 크기)

### 프론트엔드 변경
1. **그래프 컴포넌트** (`SeedAI/frontend/src/components/GrowthChart.jsx`)
   - Y축 `domain` 속성 동적 설정 (`minSize`, `maxSize` 기반)
   - 예상 그래프 라인 제거
   - Area 영역 제거
   - 좋은/나쁜 조건 그래프만 표시

2. **데이터 처리** (`SeedAI/frontend/src/pages/Growth.jsx`)
   - `minSize`, `maxSize` 데이터 추가
   - `expected_growth` 참조 제거

---

## 📊 사용된 모델/알고리즘

### 성장예측 알고리즘
- **로지스틱 곡선 기반** 계산
- **식물 종별 크기 범위**: 
  - 소형 식물: 5-30cm
  - 중형 식물: 10-60cm
  - 대형 식물: 20-150cm
- **성장률 배수**:
  - 좋은 조건: 1.3배 (30% 빠른 성장)
  - 나쁜 조건: 0.7배 (30% 느린 성장)

### 텍스트 분석 생성
- **템플릿 기반** 한국어 텍스트 생성
- 기간별 단계 분류:
  - 초기 (0개월)
  - 초기 성장 (1-3개월)
  - 중기 성장 (4-6개월)
  - 후기 성장 (7개월 이상)

---

## 🎯 주요 특징

1. **종분석 기반 동적 그래프**: 각 식물 종의 특성에 맞는 Y축 범위
2. **명확한 비교**: 좋은/나쁜 조건만 표시하여 직관적 비교
3. **상세한 분석 정보**: 각 기간별 텍스트 분석 제공
4. **실제 크기 기반**: cm 단위의 실제 식물 크기 표시

---

## 📍 관련 파일

### 백엔드
- `app/models/schemas.py`: 스키마 정의
- `app/services/growth.py`: 그래프 생성 로직
- `app/api/plant.py`: API 엔드포인트

### 프론트엔드
- `SeedAI/frontend/src/components/GrowthChart.jsx`: 그래프 컴포넌트
- `SeedAI/frontend/src/components/home/GrowthChart.jsx`: 홈 그래프 컴포넌트
- `SeedAI/frontend/src/pages/Growth.jsx`: 성장 페이지

---

## 🔄 API 응답 형식

```json
{
  "growth_graph": {
    "good_growth": [
      {"period": 0, "size": 8.5},
      {"period": 1, "size": 12.3},
      ...
    ],
    "bad_growth": [
      {"period": 0, "size": 8.5},
      {"period": 1, "size": 10.1},
      ...
    ],
    "min_size": 7.7,  // Y축 시작값 (발아단계)
    "max_size": 27.5, // Y축 끝값 (최대 크기)
    "period_unit": "month",
    "plant_name": "식물명",
    "period_analyses": [
      {
        "period": 0,
        "good_condition_analysis": "좋은 조건 분석 텍스트...",
        "bad_condition_description": "나쁜 조건 설명...",
        "bad_condition_impact": "나쁜 조건 영향..."
      },
      ...
    ]
  }
}
```

---

**업데이트 날짜**: 2024년
**버전**: v2.1
**팀 공유용 요약 문서**

